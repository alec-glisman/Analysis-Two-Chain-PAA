<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>colvar_parallel.hbonds module &mdash; Analysis Two Chain PAA v2.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="colvar_parallel.polymerlengths module" href="colvar_parallel.polymerlengths.html" />
    <link rel="prev" title="colvar_parallel.dihedrals module" href="colvar_parallel.dihedrals.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Analysis Two Chain PAA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="analysis_helpers.html">analysis_helpers package</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="colvar_parallel.html">colvar_parallel package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="colvar_parallel.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="colvar_parallel.base.html">colvar_parallel.base module</a></li>
<li class="toctree-l3"><a class="reference internal" href="colvar_parallel.contactmatrix.html">colvar_parallel.contactmatrix module</a></li>
<li class="toctree-l3"><a class="reference internal" href="colvar_parallel.contacts.html">colvar_parallel.contacts module</a></li>
<li class="toctree-l3"><a class="reference internal" href="colvar_parallel.dihedrals.html">colvar_parallel.dihedrals module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">colvar_parallel.hbonds module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hydrogen-bond-analysis-colvar-parallel-hbond-analysis">Hydrogen Bond Analysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">colvar_parallel.hbond_analysis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="colvar_parallel.polymerlengths.html">colvar_parallel.polymerlengths module</a></li>
<li class="toctree-l3"><a class="reference internal" href="colvar_parallel.rdf.html">colvar_parallel.rdf module</a></li>
<li class="toctree-l3"><a class="reference internal" href="colvar_parallel.rmsd.html">colvar_parallel.rmsd module</a></li>
<li class="toctree-l3"><a class="reference internal" href="colvar_parallel.rmsdpair.html">colvar_parallel.rmsdpair module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="colvar_parallel.html#module-colvar_parallel">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="figures.html">figures package</a></li>
<li class="toctree-l1"><a class="reference internal" href="stats.html">stats package</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Key files:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="colvar_parallel.base.html">colvar_parallel.base module</a></li>
<li class="toctree-l1"><a class="reference internal" href="stats.block_error.html">stats.block_error module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External links:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://www.dask.org/get-started">Dask</a></li>
<li class="toctree-l1"><a class="reference external" href="https://userguide.mdanalysis.org/stable/examples/quickstart.html">MDAnalysis Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://userguide.mdanalysis.org/stable/examples/README.html">MDAnalysis Examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.mdanalysis.org/stable/documentation_pages/analysis_modules.html">MDAnalysis Analysis Modules</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.plumed.org/doc-v2.8/user-doc/html/tutorials.html">Plumed Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Analysis Two Chain PAA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="colvar_parallel.html">colvar_parallel package</a></li>
      <li class="breadcrumb-item active">colvar_parallel.hbonds module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/colvar_parallel.hbonds.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-colvar_parallel.hbonds">
<span id="colvar-parallel-hbonds-module"></span><h1>colvar_parallel.hbonds module<a class="headerlink" href="#module-colvar_parallel.hbonds" title="Permalink to this heading"></a></h1>
<section id="hydrogen-bond-analysis-colvar-parallel-hbond-analysis">
<h2>Hydrogen Bond Analysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">colvar_parallel.hbond_analysis</span></code><a class="headerlink" href="#hydrogen-bond-analysis-colvar-parallel-hbond-analysis" title="Permalink to this heading"></a></h2>
<p>This module contains parallel versions of analysis tasks in
<code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hbonds.hbond_analysis</span></code>.</p>
<section id="see-also">
<h3>See Also<a class="headerlink" href="#see-also" title="Permalink to this heading"></a></h3>
<p>MDAnalysis.analysis.hbonds.hbond_analysis</p>
</section>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">colvar_parallel.hbonds.</span></span><span class="sig-name descname"><span class="pre">HydrogenBondAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">between</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">donors_sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hydrogens_sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptors_sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_h_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_a_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_h_a_angle_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_selections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="colvar_parallel.base.html#colvar_parallel.base.ParallelAnalysisBase" title="colvar_parallel.base.ParallelAnalysisBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParallelAnalysisBase</span></code></a></p>
<p>Perform an analysis of hydrogen bonds in a Universe.</p>
<p>Set up atom selections and geometric criteria for finding hydrogen
bonds in a Universe.</p>
<section id="parameters">
<h4>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading"></a></h4>
<dl class="simple">
<dt>universe<span class="classifier">Universe</span></dt><dd><p>MDAnalysis Universe object</p>
</dd>
<dt>label<span class="classifier">str (optional)</span></dt><dd><p>Label for the <a class="reference internal" href="#id0" title="colvar_parallel.hbonds.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a> object. Used for
saving <code class="xref py py-attr docutils literal notranslate"><span class="pre">df</span></code> to file. If not specified, defaults to None.</p>
</dd>
<dt>between<span class="classifier">List (optional),</span></dt><dd><p>Specify two selection strings for non-updating atom groups between
which hydrogen bonds will be calculated. For example, if the donor
and acceptor selections include both protein and water, it is
possible to find only protein-water hydrogen bonds - and not
protein-protein or water-water - by specifying
between=[“protein”, “SOL”]`. If a two-dimensional list is
passed, hydrogen bonds between each pair will be found. For
example, between=[[“protein”, “SOL”], [“protein”, “protein”]]`
will calculate all protein-water and protein-protein hydrogen
bonds but not water-water hydrogen bonds. If <cite>None</cite>, hydrogen
bonds between all donors and acceptors will be calculated.</p>
</dd>
<dt>donors_sel<span class="classifier">str</span></dt><dd><p>Selection string for the hydrogen bond donor atoms. If the
universe topology contains bonding information, leave
<code class="xref py py-attr docutils literal notranslate"><span class="pre">donors_sel</span></code> as <cite>None</cite> so that donor-hydrogen pairs can be
correctly identified.</p>
</dd>
<dt>hydrogens_sel<span class="classifier">str</span></dt><dd><p>Selection string for the hydrogen bond hydrogen atoms. Leave as
<cite>None</cite> to guess which hydrogens to use in the analysis using
<a class="reference internal" href="#id67" title="colvar_parallel.hbonds.HydrogenBondAnalysis.guess_hydrogens"><code class="xref py py-attr docutils literal notranslate"><span class="pre">guess_hydrogens</span></code></a>. If <code class="xref py py-attr docutils literal notranslate"><span class="pre">hydrogens_sel</span></code> is left as
<cite>None</cite>, also leave <code class="xref py py-attr docutils literal notranslate"><span class="pre">donors_sel</span></code> as None so that
donor-hydrogen pairs can be correctly identified.</p>
</dd>
<dt>acceptors_sel<span class="classifier">str</span></dt><dd><p>Selection string for the hydrogen bond acceptor atoms. Leave as
<cite>None</cite> to guess which atoms to use in the analysis using
<a class="reference internal" href="#id59" title="colvar_parallel.hbonds.HydrogenBondAnalysis.guess_acceptors"><code class="xref py py-attr docutils literal notranslate"><span class="pre">guess_acceptors</span></code></a></p>
</dd>
<dt>d_h_cutoff<span class="classifier">float (optional)</span></dt><dd><p>Distance cutoff used for finding donor-hydrogen pairs [1.2]. Only
used to find donor-hydrogen pairs if the universe topology does
not contain bonding information</p>
</dd>
<dt>d_a_cutoff<span class="classifier">float (optional)</span></dt><dd><p>Distance cutoff for hydrogen bonds. This cutoff refers to the
D-A distance. [3.0]</p>
</dd>
<dt>d_h_a_angle_cutoff: float (optional)</dt><dd><p>D-H-A angle cutoff for hydrogen bonds, in degrees. [150]</p>
</dd>
<dt>update_selections: bool (optional)</dt><dd><p>Whether or not to update the acceptor, donor and hydrogen lists at
each frame. [True]</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, print additional information. Default is False.</p>
</dd>
<dt><a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs</dt><dd><p>Additional keyword arguments for <code class="xref py py-class docutils literal notranslate"><span class="pre">ParallelAnalysisBase</span></code>.</p>
</dd>
</dl>
</section>
<section id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h4>
<p>The simplest use case is to allow <a class="reference internal" href="#id0" title="colvar_parallel.hbonds.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a> to
guess the acceptor and hydrogen atoms, and to identify donor-hydrogen
pairs via the bonding information in the topology:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">from</span> <span class="nn">colvar_parallel.hbond_analysis</span> <span class="kn">import</span> <span class="n">HydrogenBondAnalysis</span> <span class="k">as</span> <span class="n">HBA</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>

<span class="n">hbonds</span> <span class="o">=</span> <span class="n">HBA</span><span class="p">(</span><span class="n">universe</span><span class="o">=</span><span class="n">u</span><span class="p">)</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>It is also possible to specify which hydrogens and acceptors to use
in the analysis. For example, to find all hydrogen bonds in water:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">from</span> <span class="nn">colvar_parallel.hbond_analysis</span> <span class="kn">import</span> <span class="n">HydrogenBondAnalysis</span> <span class="k">as</span> <span class="n">HBA</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>

<span class="n">hbonds</span> <span class="o">=</span> <span class="n">HBA</span><span class="p">(</span><span class="n">universe</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
             <span class="n">hydrogens_sel</span><span class="o">=</span><span class="s2">&quot;resname TIP3 and name H1 H2&quot;</span><span class="p">,</span>
             <span class="n">acceptors_sel</span><span class="o">=</span><span class="s2">&quot;resname TIP3 and name OH2&quot;</span><span class="p">)</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Alternatively, <code class="xref py py-attr docutils literal notranslate"><span class="pre">hydrogens_sel</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">acceptors_sel</span></code> may be
generated via the <a class="reference internal" href="#id67" title="colvar_parallel.hbonds.HydrogenBondAnalysis.guess_hydrogens"><code class="xref py py-attr docutils literal notranslate"><span class="pre">guess_hydrogens</span></code></a> and <a class="reference internal" href="#id59" title="colvar_parallel.hbonds.HydrogenBondAnalysis.guess_acceptors"><code class="xref py py-attr docutils literal notranslate"><span class="pre">guess_acceptors</span></code></a>.
This selection strings may then be modified prior to calling
<a class="reference internal" href="#id75" title="colvar_parallel.hbonds.HydrogenBondAnalysis.run"><code class="xref py py-attr docutils literal notranslate"><span class="pre">run</span></code></a>, or a subset of the universe may be used to guess the
atoms. For example, find hydrogens and acceptors belonging to a
protein:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">from</span> <span class="nn">colvar_parallel.hbond_analysis</span> <span class="kn">import</span> <span class="n">HydrogenBondAnalysis</span> <span class="k">as</span> <span class="n">HBA</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>

<span class="n">hbonds</span> <span class="o">=</span> <span class="n">HBA</span><span class="p">(</span><span class="n">universe</span><span class="o">=</span><span class="n">u</span><span class="p">)</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">hydrogens_sel</span> <span class="o">=</span> <span class="n">hbonds</span><span class="o">.</span><span class="n">guess_hydrogens</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">acceptors_sel</span> <span class="o">=</span> <span class="n">hbonds</span><span class="o">.</span><span class="n">guess_acceptors</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Slightly more complex selection strings are also possible.
For example, to find hydrogen bonds involving a protein and
any water molecules within 10 Å of the protein (which may be useful
for subsequently finding the lifetime of protein-water hydrogen bonds
or finding water-bridging hydrogen bond paths):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">from</span> <span class="nn">colvar_parallel.hbond_analysis</span> <span class="kn">import</span> <span class="n">HydrogenBondAnalysis</span> <span class="k">as</span> <span class="n">HBA</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>

<span class="n">hbonds</span> <span class="o">=</span> <span class="n">HBA</span><span class="p">(</span><span class="n">universe</span><span class="o">=</span><span class="n">u</span><span class="p">)</span>

<span class="n">protein_hydrogens_sel</span> <span class="o">=</span> <span class="n">hbonds</span><span class="o">.</span><span class="n">guess_hydrogens</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>
<span class="n">protein_acceptors_sel</span> <span class="o">=</span> <span class="n">hbonds</span><span class="o">.</span><span class="n">guess_acceptors</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>

<span class="n">water_hydrogens_sel</span> <span class="o">=</span> <span class="s2">&quot;resname TIP3 and name H1 H2&quot;</span>
<span class="n">water_acceptors_sel</span> <span class="o">=</span> <span class="s2">&quot;resname TIP3 and name OH2&quot;</span>

<span class="n">hbonds</span><span class="o">.</span><span class="n">hydrogens_sel</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">protein_hydrogens_sel</span><span class="si">}</span><span class="s2">) or</span>
          <span class="p">({</span><span class="n">water_hydrogens_sel</span><span class="p">}</span> <span class="ow">and</span> <span class="n">around</span> <span class="mi">10</span> <span class="ow">not</span> <span class="n">resname</span> <span class="n">TIP3</span><span class="p">})</span><span class="s2">&quot;</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">acceptors_sel</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">protein_acceptors_sel</span><span class="si">}</span><span class="s2">) or</span>
          <span class="p">({</span><span class="n">water_acceptors_sel</span><span class="p">}</span> <span class="ow">and</span> <span class="n">around</span> <span class="mi">10</span> <span class="ow">not</span> <span class="n">resname</span> <span class="n">TIP3</span><span class="p">})</span><span class="s2">&quot;</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>It is highly recommended that a topology with bonding information is
used to generate the universe, e.g <cite>PSF</cite>, <cite>TPR</cite>, or <cite>PRMTOP</cite> files.
This is the only method by which it can be guaranteed that
donor-hydrogen pairs are correctly identified. However, if, for
example, a <cite>PDB</cite> file is used instead, a <code class="xref py py-attr docutils literal notranslate"><span class="pre">donors_sel</span></code> may be
provided along with a <code class="xref py py-attr docutils literal notranslate"><span class="pre">hydrogens_sel</span></code> and the donor-hydrogen
pairs will be identified via a distance cutoff, <code class="xref py py-attr docutils literal notranslate"><span class="pre">d_h_cutoff</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">from</span> <span class="nn">colvar_parallel.hbond_analysis</span> <span class="kn">import</span> <span class="n">HydrogenBondAnalysis</span> <span class="k">as</span> <span class="n">HBA</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>

<span class="n">hbonds</span> <span class="o">=</span> <span class="n">HBA</span><span class="p">(</span>
  <span class="n">universe</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
  <span class="n">donors_sel</span><span class="o">=</span><span class="s2">&quot;resname TIP3 and name OH2&quot;</span><span class="p">,</span>
  <span class="n">hydrogens_sel</span><span class="o">=</span><span class="s2">&quot;resname TIP3 and name H1 H2&quot;</span><span class="p">,</span>
  <span class="n">acceptors_sel</span><span class="o">=</span><span class="s2">&quot;resname TIP3 and name OH2&quot;</span><span class="p">,</span>
  <span class="n">d_h_cutoff</span><span class="o">=</span><span class="mf">1.2</span>
<span class="p">)</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis._conclude">
<span class="sig-name descname"><span class="pre">_conclude</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._conclude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis._conclude" title="Permalink to this definition"></a></dt>
<dd><p>Finalize the results of the calculation. This is called once
after the analysis is finished inside the run() method. The method
concatenates the results from the single frame analysis and
input weights dataframe, if provided.</p>
<section id="raises">
<h5>Raises<a class="headerlink" href="#raises" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>ValueError</dt><dd><p>If no results are found.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis._filter_atoms">
<span class="sig-name descname"><span class="pre">_filter_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">donors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._filter_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis._filter_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Create a mask to filter donor, hydrogen and acceptor atoms.</p>
<p>This can be used to consider only hydrogen bonds between two or more
specified groups.</p>
<p>Groups are specified with the <cite>between</cite> keyword when creating the
HydrogenBondAnalysis object.</p>
<section id="returns">
<h5>Returns<a class="headerlink" href="#returns" title="Permalink to this heading"></a></h5>
<p>mask: np.ndarray</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.5.0: </span>Change return value to a mask instead of separate AtomGroups.</p>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis._get_dh_pairs">
<span class="sig-name descname"><span class="pre">_get_dh_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._get_dh_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis._get_dh_pairs" title="Permalink to this definition"></a></dt>
<dd><p>Finds donor-hydrogen pairs.</p>
<section id="id3">
<h5>Returns<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>donors, hydrogens: AtomGroup, AtomGroup</dt><dd><p>AtomGroups corresponding to all donors and all hydrogens.
AtomGroups are ordered such that, if zipped, will produce a list
of donor-hydrogen pairs.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis._job_block">
<span class="sig-name descname"><span class="pre">_job_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">absolute_frame_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis._job_block" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to actually setup the Dask tasks</p>
<section id="id4">
<h5>Parameters<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>absolute_frame_indices<span class="classifier">np.array</span></dt><dd><p>Array of frame indices to analyze. These indices are absolute
and refer to frame numbers in the trajectory.</p>
</dd>
</dl>
</section>
<section id="id5">
<h5>Returns<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>np.array</dt><dd><p>Array of results from the analysis of the frames</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis._prepare">
<span class="sig-name descname"><span class="pre">_prepare</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._prepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis._prepare" title="Permalink to this definition"></a></dt>
<dd><p>Prepare the analysis class for the single frame analysis.
This is called once before the analysis is started inside
the run() method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis._reduce">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_single_frame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis._reduce" title="Permalink to this definition"></a></dt>
<dd><p>Use numpy array append to combine results</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis._setup_frames">
<span class="sig-name descname"><span class="pre">_setup_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis._setup_frames" title="Permalink to this definition"></a></dt>
<dd><p>Pass a Reader object and define the desired iteration pattern
through the trajectory</p>
<section id="id6">
<h5>Parameters<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h5>
<dl>
<dt>trajectory<span class="classifier">mda.Reader</span></dt><dd><p>A trajectory Reader</p>
</dd>
<dt>start<span class="classifier">int, optional</span></dt><dd><p>start frame of analysis</p>
</dd>
<dt>stop<span class="classifier">int, optional</span></dt><dd><p>stop frame of analysis</p>
</dd>
<dt>step<span class="classifier">int, optional</span></dt><dd><p>number of frames to skip between each analysed frame</p>
</dd>
<dt>frames<span class="classifier">array_like, optional</span></dt><dd><p>array of integers or booleans to slice trajectory; cannot be
combined with <cite>start</cite>, <cite>stop</cite>, <cite>step</cite></p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.0.</span></p>
</div>
</dd>
</dl>
</section>
<section id="id7">
<h5>Raises<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>ValueError</dt><dd><p>if <em>both</em> <cite>frames</cite> and at least one of <cite>start</cite>, <cite>stop</cite>, or <cite>frames</cite>
is provided (i.e., set to another value than <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.0.0: </span>Added .frames and .times arrays as attributes</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.0: </span>Added ability to iterate through trajectory by passing a list of
frame indices in the <cite>frames</cite> keyword argument</p>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis._single_frame">
<span class="sig-name descname"><span class="pre">_single_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_frame</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._single_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis._single_frame" title="Permalink to this definition"></a></dt>
<dd><p>Analyze a single frame in the trajectory.</p>
<section id="id8">
<h5>Parameters<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>idx_frame: int</dt><dd><p>Index of the frame to analyze.</p>
</dd>
</dl>
</section>
<section id="id9">
<h5>Returns<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>np.array</dt><dd><p>Array of hydrogen bonds for the current frame.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis.count_by_ids">
<span class="sig-name descname"><span class="pre">count_by_ids</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.count_by_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis.count_by_ids" title="Permalink to this definition"></a></dt>
<dd><p>Counts the total number hydrogen bonds formed by unique
combinations of donor, hydrogen and acceptor atoms.</p>
<section id="id10">
<h5>Returns<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>counts<span class="classifier">numpy.ndarray</span></dt><dd><p>Each row of the array contains the donor atom id, hydrogen atom
id, acceptor atom id and the total number of times the hydrogen
bond was observed. The array is sorted by frequency of
occurrence.</p>
</dd>
</dl>
</section>
<section id="note">
<h5>Note<a class="headerlink" href="#note" title="Permalink to this heading"></a></h5>
<p>Unique hydrogen bonds are determined through a consideration of the
hydrogen atom id and acceptor atom id in a hydrogen bond.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis.count_by_time">
<span class="sig-name descname"><span class="pre">count_by_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.count_by_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis.count_by_time" title="Permalink to this definition"></a></dt>
<dd><p>Counts the number of hydrogen bonds per timestep.
Returns
——-
counts : numpy.ndarray</p>
<blockquote>
<div><p>Contains the total number of hydrogen bonds found at each
timestep.
Can be used along with <code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.timesteps</span></code> to
plot the number of hydrogen bonds over time.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis.count_by_type">
<span class="sig-name descname"><span class="pre">count_by_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.count_by_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis.count_by_type" title="Permalink to this definition"></a></dt>
<dd><p>Counts the total number of each unique type of hydrogen bond.</p>
<section id="id11">
<h5>Returns<a class="headerlink" href="#id11" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>counts<span class="classifier">numpy.ndarray</span></dt><dd><p>Each row of the array contains the donor resname, donor atom
type, acceptor resname, acceptor atom type and the total number
of times the hydrogen bond was found.</p>
</dd>
</dl>
</section>
<section id="id12">
<h5>Note<a class="headerlink" href="#id12" title="Permalink to this heading"></a></h5>
<p>Unique hydrogen bonds are determined through a consideration of the
resname and atom type of the donor and acceptor atoms in a hydrogen
bond.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis.guess_acceptors">
<span class="sig-name descname"><span class="pre">guess_acceptors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.guess_acceptors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis.guess_acceptors" title="Permalink to this definition"></a></dt>
<dd><p>Guesses which atoms could be considered acceptors in the analysis.</p>
<section id="id13">
<h5>Parameters<a class="headerlink" href="#id13" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>selection: str (optional)</dt><dd><p>Selection string for atom group from which acceptors will be
identified.</p>
</dd>
<dt>max_charge: float (optional)</dt><dd><p>Maximum allowed charge of an acceptor atom.</p>
</dd>
</dl>
</section>
<section id="id14">
<h5>Returns<a class="headerlink" href="#id14" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>potential_acceptors: str</dt><dd><p>String containing the <code class="xref py py-attr docutils literal notranslate"><span class="pre">resname</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> of all
atoms that potentially capable of forming hydrogen bonds.</p>
</dd>
</dl>
</section>
<section id="notes">
<h5>Notes<a class="headerlink" href="#notes" title="Permalink to this heading"></a></h5>
<p>This function makes use of and atomic charges to identify which atoms
could be considered acceptor atoms in the hydrogen bond analysis.
If an atom has an atomic charge less than <code class="xref py py-attr docutils literal notranslate"><span class="pre">max_charge</span></code> then it
is considered capable of participating in hydrogen bonds.</p>
<p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">acceptors_sel</span></code> is <cite>None</cite>, this function is called to guess
the selection.</p>
<p>Alternatively, this function may be used to quickly generate a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> of potential acceptor atoms involved in hydrogen bonding.
This <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> may then be modified before being used to set the
attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">acceptors_sel</span></code>.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis.guess_donors">
<span class="sig-name descname"><span class="pre">guess_donors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.guess_donors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis.guess_donors" title="Permalink to this definition"></a></dt>
<dd><p>Guesses which atoms could be considered donors in the analysis.
Only use if the universe topology does not contain bonding
information, otherwise donor-hydrogen pairs may be incorrectly
assigned.</p>
<section id="id15">
<h5>Parameters<a class="headerlink" href="#id15" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>selection: str (optional)</dt><dd><p>Selection string for atom group from which donors will be
identified.</p>
</dd>
<dt>max_charge: float (optional)</dt><dd><p>Maximum allowed charge of a donor atom.</p>
</dd>
</dl>
</section>
<section id="id16">
<h5>Returns<a class="headerlink" href="#id16" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>potential_donors: str</dt><dd><p>String containing the <code class="xref py py-attr docutils literal notranslate"><span class="pre">resname</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> of all
atoms that potentially capable of forming hydrogen bonds.</p>
</dd>
</dl>
</section>
<section id="id17">
<h5>Notes<a class="headerlink" href="#id17" title="Permalink to this heading"></a></h5>
<p>This function makes use of and atomic charges to identify which atoms
could be considered donor atoms in the hydrogen bond analysis. If an
atom has an atomic charge less than <code class="xref py py-attr docutils literal notranslate"><span class="pre">max_charge</span></code>, and it is
within <code class="xref py py-attr docutils literal notranslate"><span class="pre">d_h_cutoff</span></code> of a hydrogen atom, then it is considered
capable of participating in hydrogen bonds.</p>
<p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">donors_sel</span></code> is <cite>None</cite>, and the universe topology does not
have bonding information, this function is called to guess the
selection.</p>
<p>Alternatively, this function may be used to quickly generate a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> of potential donor atoms involved in hydrogen bonding.
This <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> may then be modified before being used to set the
attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">donors_sel</span></code>.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis.guess_hydrogens">
<span class="sig-name descname"><span class="pre">guess_hydrogens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.guess_hydrogens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis.guess_hydrogens" title="Permalink to this definition"></a></dt>
<dd><p>Guesses which hydrogen atoms should be used in the analysis.</p>
<section id="id18">
<h5>Parameters<a class="headerlink" href="#id18" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>selection: str (optional)</dt><dd><p>Selection string for atom group from which hydrogens will be
identified.</p>
</dd>
<dt>max_mass: float (optional)</dt><dd><p>Maximum allowed mass of a hydrogen atom.</p>
</dd>
<dt>min_charge: float (optional)</dt><dd><p>Minimum allowed charge of a hydrogen atom.</p>
</dd>
</dl>
</section>
<section id="id19">
<h5>Returns<a class="headerlink" href="#id19" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>potential_hydrogens: str</dt><dd><p>String containing the <code class="xref py py-attr docutils literal notranslate"><span class="pre">resname</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> of all
hydrogen atoms potentially capable of forming hydrogen bonds.</p>
</dd>
</dl>
</section>
<section id="id20">
<h5>Notes<a class="headerlink" href="#id20" title="Permalink to this heading"></a></h5>
<p>This function makes use of atomic masses and atomic charges to
identify which atoms are hydrogen atoms that are capable of
participating in hydrogen bonding. If an atom has a mass less than
<code class="xref py py-attr docutils literal notranslate"><span class="pre">max_mass</span></code> and an atomic charge greater than <code class="xref py py-attr docutils literal notranslate"><span class="pre">min_charge</span></code>
then it is considered capable of participating in hydrogen bonds.</p>
<p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">hydrogens_sel</span></code> is <cite>None</cite>, this function is called to guess
the selection.</p>
<p>Alternatively, this function may be used to quickly generate a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> of potential hydrogen atoms involved in hydrogen bonding.
This str may then be modified before being used to set the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">hydrogens_sel</span></code>.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis.merge_external_data">
<span class="sig-name descname"><span class="pre">merge_external_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'time'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis.merge_external_data" title="Permalink to this definition"></a></dt>
<dd><p>Merge external data with the results of the analysis</p>
<section id="id21">
<h5>Parameters<a class="headerlink" href="#id21" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>df<span class="classifier">pd.DataFrame</span></dt><dd><p>Dataframe containing the data to merge</p>
</dd>
<dt>col<span class="classifier">str, optional</span></dt><dd><p>Column name to merge on, by default “time”</p>
</dd>
</dl>
</section>
<section id="id22">
<h5>Returns<a class="headerlink" href="#id22" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>pd.DataFrame</dt><dd><p>Dataframe with merged data</p>
</dd>
</dl>
</section>
<section id="id23">
<h5>Raises<a class="headerlink" href="#id23" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>ValueError</dt><dd><p>If no results are present</p>
</dd>
<dt>ValueError</dt><dd><p>If no data is merged</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'dask'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="colvar_parallel.base.html#colvar_parallel.base.ParallelAnalysisBase" title="colvar_parallel.base.ParallelAnalysisBase"><span class="pre">ParallelAnalysisBase</span></a></span></span><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis.run" title="Permalink to this definition"></a></dt>
<dd><p>Perform the calculation</p>
<section id="id24">
<h5>Parameters<a class="headerlink" href="#id24" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>start<span class="classifier">int, optional</span></dt><dd><p>start frame of analysis</p>
</dd>
<dt>stop<span class="classifier">int, optional</span></dt><dd><p>stop frame of analysis</p>
</dd>
<dt>step<span class="classifier">int, optional</span></dt><dd><p>number of frames to skip between each analysed frame</p>
</dd>
<dt>frames<span class="classifier">array_like, optional</span></dt><dd><p>array of integers or booleans to slice trajectory; <cite>frames</cite> can
only be used <em>instead</em> of <cite>start</cite>, <cite>stop</cite>, and <cite>step</cite>. Setting
<em>both</em> <cite>frames</cite> and at least one of <cite>start</cite>, <cite>stop</cite>, <cite>step</cite> to a
non-default value will raise a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>.
.. versionadded:: 2.2.0</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>Turn on verbosity</p>
</dd>
<dt>n_jobs<span class="classifier">int, optional</span></dt><dd><p>number of jobs to start, if <cite>-1</cite> use number of logical cpu cores.
This argument will be ignored when the distributed scheduler is
used
.. versionadded:: PERSONAL-COPY</p>
</dd>
<dt>module<span class="classifier">str, optional</span></dt><dd><p>Parallelization module to use. Default: <code class="docutils literal notranslate"><span class="pre">&quot;multiprocessing&quot;</span></code>.
.. versionadded:: PERSONAL-COPY</p>
</dd>
<dt>method<span class="classifier">str, optional</span></dt><dd><p>Parallelization method to use. This is the Dask scheduler,
Joblib backend, or the multiprocessing method. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.
.. versionadded:: PERSONAL-COPY</p>
</dd>
<dt>n_blocks<span class="classifier">int, optional</span></dt><dd><p>number of blocks to divide trajectory into. If <code class="docutils literal notranslate"><span class="pre">None</span></code> set equal
to n_jobs or number of available workers in scheduler.
.. versionadded:: PERSONAL-COPY</p>
</dd>
<dt><a href="#id25"><span class="problematic" id="id26">**</span></a>kwargs</dt><dd><p>Other keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">dask.base.compute()</span></code>.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.0: </span>Added ability to analyze arbitrary frames by passing a list of
frame indices in the <cite>frames</cite> keyword argument.</p>
</div>
</section>
<section id="id27">
<h5>Returns<a class="headerlink" href="#id27" title="Permalink to this heading"></a></h5>
<dl>
<dt>self<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParallelAnalysisBase</span></code> instance</span></dt><dd><p>The instance itself.</p>
</dd>
</dl>
</section>
<section id="id28">
<h5>Raises<a class="headerlink" href="#id28" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>ValueError</dt><dd><p>If <cite>frames</cite> is used in conjunction with <cite>start</cite>, <cite>stop</cite>, or <cite>step</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis.save" title="Permalink to this definition"></a></dt>
<dd><p>Save the results of the analysis to a parquet file. The results
are saved to the <cite>data</cite> directory in the <cite>dir_out</cite> directory.</p>
<p>This method should only be called after the analysis has been
run.</p>
<section id="id29">
<h5>Parameters<a class="headerlink" href="#id29" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>dir_out<span class="classifier">str, optional</span></dt><dd><p>The directory to save the results to. If not specified, the
results are saved to the directory specified in the
<cite>dir_out</cite> attribute.</p>
</dd>
</dl>
</section>
<section id="id30">
<h5>Raises<a class="headerlink" href="#id30" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>ValueError</dt><dd><p>If no dataframe is found.</p>
</dd>
<dt>ValueError</dt><dd><p>If no filename is found.</p>
</dd>
<dt>ValueError</dt><dd><p>If no output directory is specified.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

</section>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">colvar_parallel.hbonds.</span></span><span class="sig-name descname"><span class="pre">HydrogenBondAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">between</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">donors_sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hydrogens_sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptors_sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_h_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_a_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_h_a_angle_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_selections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="colvar_parallel.base.html#colvar_parallel.base.ParallelAnalysisBase" title="colvar_parallel.base.ParallelAnalysisBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParallelAnalysisBase</span></code></a></p>
<p>Perform an analysis of hydrogen bonds in a Universe.</p>
<p>Set up atom selections and geometric criteria for finding hydrogen
bonds in a Universe.</p>
<section id="id31">
<h2>Parameters<a class="headerlink" href="#id31" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>universe<span class="classifier">Universe</span></dt><dd><p>MDAnalysis Universe object</p>
</dd>
<dt>label<span class="classifier">str (optional)</span></dt><dd><p>Label for the <a class="reference internal" href="#id0" title="colvar_parallel.hbonds.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a> object. Used for
saving <code class="xref py py-attr docutils literal notranslate"><span class="pre">df</span></code> to file. If not specified, defaults to None.</p>
</dd>
<dt>between<span class="classifier">List (optional),</span></dt><dd><p>Specify two selection strings for non-updating atom groups between
which hydrogen bonds will be calculated. For example, if the donor
and acceptor selections include both protein and water, it is
possible to find only protein-water hydrogen bonds - and not
protein-protein or water-water - by specifying
between=[“protein”, “SOL”]`. If a two-dimensional list is
passed, hydrogen bonds between each pair will be found. For
example, between=[[“protein”, “SOL”], [“protein”, “protein”]]`
will calculate all protein-water and protein-protein hydrogen
bonds but not water-water hydrogen bonds. If <cite>None</cite>, hydrogen
bonds between all donors and acceptors will be calculated.</p>
</dd>
<dt>donors_sel<span class="classifier">str</span></dt><dd><p>Selection string for the hydrogen bond donor atoms. If the
universe topology contains bonding information, leave
<code class="xref py py-attr docutils literal notranslate"><span class="pre">donors_sel</span></code> as <cite>None</cite> so that donor-hydrogen pairs can be
correctly identified.</p>
</dd>
<dt>hydrogens_sel<span class="classifier">str</span></dt><dd><p>Selection string for the hydrogen bond hydrogen atoms. Leave as
<cite>None</cite> to guess which hydrogens to use in the analysis using
<a class="reference internal" href="#id67" title="colvar_parallel.hbonds.HydrogenBondAnalysis.guess_hydrogens"><code class="xref py py-attr docutils literal notranslate"><span class="pre">guess_hydrogens</span></code></a>. If <code class="xref py py-attr docutils literal notranslate"><span class="pre">hydrogens_sel</span></code> is left as
<cite>None</cite>, also leave <code class="xref py py-attr docutils literal notranslate"><span class="pre">donors_sel</span></code> as None so that
donor-hydrogen pairs can be correctly identified.</p>
</dd>
<dt>acceptors_sel<span class="classifier">str</span></dt><dd><p>Selection string for the hydrogen bond acceptor atoms. Leave as
<cite>None</cite> to guess which atoms to use in the analysis using
<a class="reference internal" href="#id59" title="colvar_parallel.hbonds.HydrogenBondAnalysis.guess_acceptors"><code class="xref py py-attr docutils literal notranslate"><span class="pre">guess_acceptors</span></code></a></p>
</dd>
<dt>d_h_cutoff<span class="classifier">float (optional)</span></dt><dd><p>Distance cutoff used for finding donor-hydrogen pairs [1.2]. Only
used to find donor-hydrogen pairs if the universe topology does
not contain bonding information</p>
</dd>
<dt>d_a_cutoff<span class="classifier">float (optional)</span></dt><dd><p>Distance cutoff for hydrogen bonds. This cutoff refers to the
D-A distance. [3.0]</p>
</dd>
<dt>d_h_a_angle_cutoff: float (optional)</dt><dd><p>D-H-A angle cutoff for hydrogen bonds, in degrees. [150]</p>
</dd>
<dt>update_selections: bool (optional)</dt><dd><p>Whether or not to update the acceptor, donor and hydrogen lists at
each frame. [True]</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, print additional information. Default is False.</p>
</dd>
<dt><a href="#id32"><span class="problematic" id="id33">**</span></a>kwargs</dt><dd><p>Additional keyword arguments for <code class="xref py py-class docutils literal notranslate"><span class="pre">ParallelAnalysisBase</span></code>.</p>
</dd>
</dl>
</section>
<section id="id34">
<h2>Examples<a class="headerlink" href="#id34" title="Permalink to this heading"></a></h2>
<p>The simplest use case is to allow <a class="reference internal" href="#id0" title="colvar_parallel.hbonds.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a> to
guess the acceptor and hydrogen atoms, and to identify donor-hydrogen
pairs via the bonding information in the topology:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">from</span> <span class="nn">colvar_parallel.hbond_analysis</span> <span class="kn">import</span> <span class="n">HydrogenBondAnalysis</span> <span class="k">as</span> <span class="n">HBA</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>

<span class="n">hbonds</span> <span class="o">=</span> <span class="n">HBA</span><span class="p">(</span><span class="n">universe</span><span class="o">=</span><span class="n">u</span><span class="p">)</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>It is also possible to specify which hydrogens and acceptors to use
in the analysis. For example, to find all hydrogen bonds in water:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">from</span> <span class="nn">colvar_parallel.hbond_analysis</span> <span class="kn">import</span> <span class="n">HydrogenBondAnalysis</span> <span class="k">as</span> <span class="n">HBA</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>

<span class="n">hbonds</span> <span class="o">=</span> <span class="n">HBA</span><span class="p">(</span><span class="n">universe</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
             <span class="n">hydrogens_sel</span><span class="o">=</span><span class="s2">&quot;resname TIP3 and name H1 H2&quot;</span><span class="p">,</span>
             <span class="n">acceptors_sel</span><span class="o">=</span><span class="s2">&quot;resname TIP3 and name OH2&quot;</span><span class="p">)</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Alternatively, <code class="xref py py-attr docutils literal notranslate"><span class="pre">hydrogens_sel</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">acceptors_sel</span></code> may be
generated via the <a class="reference internal" href="#id67" title="colvar_parallel.hbonds.HydrogenBondAnalysis.guess_hydrogens"><code class="xref py py-attr docutils literal notranslate"><span class="pre">guess_hydrogens</span></code></a> and <a class="reference internal" href="#id59" title="colvar_parallel.hbonds.HydrogenBondAnalysis.guess_acceptors"><code class="xref py py-attr docutils literal notranslate"><span class="pre">guess_acceptors</span></code></a>.
This selection strings may then be modified prior to calling
<a class="reference internal" href="#id75" title="colvar_parallel.hbonds.HydrogenBondAnalysis.run"><code class="xref py py-attr docutils literal notranslate"><span class="pre">run</span></code></a>, or a subset of the universe may be used to guess the
atoms. For example, find hydrogens and acceptors belonging to a
protein:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">from</span> <span class="nn">colvar_parallel.hbond_analysis</span> <span class="kn">import</span> <span class="n">HydrogenBondAnalysis</span> <span class="k">as</span> <span class="n">HBA</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>

<span class="n">hbonds</span> <span class="o">=</span> <span class="n">HBA</span><span class="p">(</span><span class="n">universe</span><span class="o">=</span><span class="n">u</span><span class="p">)</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">hydrogens_sel</span> <span class="o">=</span> <span class="n">hbonds</span><span class="o">.</span><span class="n">guess_hydrogens</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">acceptors_sel</span> <span class="o">=</span> <span class="n">hbonds</span><span class="o">.</span><span class="n">guess_acceptors</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Slightly more complex selection strings are also possible.
For example, to find hydrogen bonds involving a protein and
any water molecules within 10 Å of the protein (which may be useful
for subsequently finding the lifetime of protein-water hydrogen bonds
or finding water-bridging hydrogen bond paths):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">from</span> <span class="nn">colvar_parallel.hbond_analysis</span> <span class="kn">import</span> <span class="n">HydrogenBondAnalysis</span> <span class="k">as</span> <span class="n">HBA</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>

<span class="n">hbonds</span> <span class="o">=</span> <span class="n">HBA</span><span class="p">(</span><span class="n">universe</span><span class="o">=</span><span class="n">u</span><span class="p">)</span>

<span class="n">protein_hydrogens_sel</span> <span class="o">=</span> <span class="n">hbonds</span><span class="o">.</span><span class="n">guess_hydrogens</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>
<span class="n">protein_acceptors_sel</span> <span class="o">=</span> <span class="n">hbonds</span><span class="o">.</span><span class="n">guess_acceptors</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>

<span class="n">water_hydrogens_sel</span> <span class="o">=</span> <span class="s2">&quot;resname TIP3 and name H1 H2&quot;</span>
<span class="n">water_acceptors_sel</span> <span class="o">=</span> <span class="s2">&quot;resname TIP3 and name OH2&quot;</span>

<span class="n">hbonds</span><span class="o">.</span><span class="n">hydrogens_sel</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">protein_hydrogens_sel</span><span class="si">}</span><span class="s2">) or</span>
          <span class="p">({</span><span class="n">water_hydrogens_sel</span><span class="p">}</span> <span class="ow">and</span> <span class="n">around</span> <span class="mi">10</span> <span class="ow">not</span> <span class="n">resname</span> <span class="n">TIP3</span><span class="p">})</span><span class="s2">&quot;</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">acceptors_sel</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">protein_acceptors_sel</span><span class="si">}</span><span class="s2">) or</span>
          <span class="p">({</span><span class="n">water_acceptors_sel</span><span class="p">}</span> <span class="ow">and</span> <span class="n">around</span> <span class="mi">10</span> <span class="ow">not</span> <span class="n">resname</span> <span class="n">TIP3</span><span class="p">})</span><span class="s2">&quot;</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>It is highly recommended that a topology with bonding information is
used to generate the universe, e.g <cite>PSF</cite>, <cite>TPR</cite>, or <cite>PRMTOP</cite> files.
This is the only method by which it can be guaranteed that
donor-hydrogen pairs are correctly identified. However, if, for
example, a <cite>PDB</cite> file is used instead, a <code class="xref py py-attr docutils literal notranslate"><span class="pre">donors_sel</span></code> may be
provided along with a <code class="xref py py-attr docutils literal notranslate"><span class="pre">hydrogens_sel</span></code> and the donor-hydrogen
pairs will be identified via a distance cutoff, <code class="xref py py-attr docutils literal notranslate"><span class="pre">d_h_cutoff</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">from</span> <span class="nn">colvar_parallel.hbond_analysis</span> <span class="kn">import</span> <span class="n">HydrogenBondAnalysis</span> <span class="k">as</span> <span class="n">HBA</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>

<span class="n">hbonds</span> <span class="o">=</span> <span class="n">HBA</span><span class="p">(</span>
  <span class="n">universe</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
  <span class="n">donors_sel</span><span class="o">=</span><span class="s2">&quot;resname TIP3 and name OH2&quot;</span><span class="p">,</span>
  <span class="n">hydrogens_sel</span><span class="o">=</span><span class="s2">&quot;resname TIP3 and name H1 H2&quot;</span><span class="p">,</span>
  <span class="n">acceptors_sel</span><span class="o">=</span><span class="s2">&quot;resname TIP3 and name OH2&quot;</span><span class="p">,</span>
  <span class="n">d_h_cutoff</span><span class="o">=</span><span class="mf">1.2</span>
<span class="p">)</span>
<span class="n">hbonds</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="id35">
<span class="sig-name descname"><span class="pre">_conclude</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._conclude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id35" title="Permalink to this definition"></a></dt>
<dd><p>Finalize the results of the calculation. This is called once
after the analysis is finished inside the run() method. The method
concatenates the results from the single frame analysis and
input weights dataframe, if provided.</p>
<section id="id36">
<h3>Raises<a class="headerlink" href="#id36" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>ValueError</dt><dd><p>If no results are found.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id37">
<span class="sig-name descname"><span class="pre">_filter_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">donors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._filter_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id37" title="Permalink to this definition"></a></dt>
<dd><p>Create a mask to filter donor, hydrogen and acceptor atoms.</p>
<p>This can be used to consider only hydrogen bonds between two or more
specified groups.</p>
<p>Groups are specified with the <cite>between</cite> keyword when creating the
HydrogenBondAnalysis object.</p>
<section id="id38">
<h3>Returns<a class="headerlink" href="#id38" title="Permalink to this heading"></a></h3>
<p>mask: np.ndarray</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.5.0: </span>Change return value to a mask instead of separate AtomGroups.</p>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id39">
<span class="sig-name descname"><span class="pre">_get_dh_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._get_dh_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id39" title="Permalink to this definition"></a></dt>
<dd><p>Finds donor-hydrogen pairs.</p>
<section id="id40">
<h3>Returns<a class="headerlink" href="#id40" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>donors, hydrogens: AtomGroup, AtomGroup</dt><dd><p>AtomGroups corresponding to all donors and all hydrogens.
AtomGroups are ordered such that, if zipped, will produce a list
of donor-hydrogen pairs.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id41">
<span class="sig-name descname"><span class="pre">_job_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">absolute_frame_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#id41" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to actually setup the Dask tasks</p>
<section id="id42">
<h3>Parameters<a class="headerlink" href="#id42" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>absolute_frame_indices<span class="classifier">np.array</span></dt><dd><p>Array of frame indices to analyze. These indices are absolute
and refer to frame numbers in the trajectory.</p>
</dd>
</dl>
</section>
<section id="id43">
<h3>Returns<a class="headerlink" href="#id43" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>np.array</dt><dd><p>Array of results from the analysis of the frames</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id44">
<span class="sig-name descname"><span class="pre">_prepare</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._prepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id44" title="Permalink to this definition"></a></dt>
<dd><p>Prepare the analysis class for the single frame analysis.
This is called once before the analysis is started inside
the run() method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id45">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_single_frame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id45" title="Permalink to this definition"></a></dt>
<dd><p>Use numpy array append to combine results</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id46">
<span class="sig-name descname"><span class="pre">_setup_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id46" title="Permalink to this definition"></a></dt>
<dd><p>Pass a Reader object and define the desired iteration pattern
through the trajectory</p>
<section id="id47">
<h3>Parameters<a class="headerlink" href="#id47" title="Permalink to this heading"></a></h3>
<dl>
<dt>trajectory<span class="classifier">mda.Reader</span></dt><dd><p>A trajectory Reader</p>
</dd>
<dt>start<span class="classifier">int, optional</span></dt><dd><p>start frame of analysis</p>
</dd>
<dt>stop<span class="classifier">int, optional</span></dt><dd><p>stop frame of analysis</p>
</dd>
<dt>step<span class="classifier">int, optional</span></dt><dd><p>number of frames to skip between each analysed frame</p>
</dd>
<dt>frames<span class="classifier">array_like, optional</span></dt><dd><p>array of integers or booleans to slice trajectory; cannot be
combined with <cite>start</cite>, <cite>stop</cite>, <cite>step</cite></p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.2.0.</span></p>
</div>
</dd>
</dl>
</section>
<section id="id48">
<h3>Raises<a class="headerlink" href="#id48" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>ValueError</dt><dd><p>if <em>both</em> <cite>frames</cite> and at least one of <cite>start</cite>, <cite>stop</cite>, or <cite>frames</cite>
is provided (i.e., set to another value than <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.0.0: </span>Added .frames and .times arrays as attributes</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.0: </span>Added ability to iterate through trajectory by passing a list of
frame indices in the <cite>frames</cite> keyword argument</p>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id49">
<span class="sig-name descname"><span class="pre">_single_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_frame</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._single_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id49" title="Permalink to this definition"></a></dt>
<dd><p>Analyze a single frame in the trajectory.</p>
<section id="id50">
<h3>Parameters<a class="headerlink" href="#id50" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>idx_frame: int</dt><dd><p>Index of the frame to analyze.</p>
</dd>
</dl>
</section>
<section id="id51">
<h3>Returns<a class="headerlink" href="#id51" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>np.array</dt><dd><p>Array of hydrogen bonds for the current frame.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="colvar_parallel.hbonds.HydrogenBondAnalysis._universe_check">
<span class="sig-name descname"><span class="pre">_universe_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis._universe_check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#colvar_parallel.hbonds.HydrogenBondAnalysis._universe_check" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id52">
<span class="sig-name descname"><span class="pre">count_by_ids</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.count_by_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id52" title="Permalink to this definition"></a></dt>
<dd><p>Counts the total number hydrogen bonds formed by unique
combinations of donor, hydrogen and acceptor atoms.</p>
<section id="id53">
<h3>Returns<a class="headerlink" href="#id53" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>counts<span class="classifier">numpy.ndarray</span></dt><dd><p>Each row of the array contains the donor atom id, hydrogen atom
id, acceptor atom id and the total number of times the hydrogen
bond was observed. The array is sorted by frequency of
occurrence.</p>
</dd>
</dl>
</section>
<section id="id54">
<h3>Note<a class="headerlink" href="#id54" title="Permalink to this heading"></a></h3>
<p>Unique hydrogen bonds are determined through a consideration of the
hydrogen atom id and acceptor atom id in a hydrogen bond.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id55">
<span class="sig-name descname"><span class="pre">count_by_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.count_by_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id55" title="Permalink to this definition"></a></dt>
<dd><p>Counts the number of hydrogen bonds per timestep.
Returns
——-
counts : numpy.ndarray</p>
<blockquote>
<div><p>Contains the total number of hydrogen bonds found at each
timestep.
Can be used along with <code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.timesteps</span></code> to
plot the number of hydrogen bonds over time.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id56">
<span class="sig-name descname"><span class="pre">count_by_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.count_by_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id56" title="Permalink to this definition"></a></dt>
<dd><p>Counts the total number of each unique type of hydrogen bond.</p>
<section id="id57">
<h3>Returns<a class="headerlink" href="#id57" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>counts<span class="classifier">numpy.ndarray</span></dt><dd><p>Each row of the array contains the donor resname, donor atom
type, acceptor resname, acceptor atom type and the total number
of times the hydrogen bond was found.</p>
</dd>
</dl>
</section>
<section id="id58">
<h3>Note<a class="headerlink" href="#id58" title="Permalink to this heading"></a></h3>
<p>Unique hydrogen bonds are determined through a consideration of the
resname and atom type of the donor and acceptor atoms in a hydrogen
bond.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id59">
<span class="sig-name descname"><span class="pre">guess_acceptors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.guess_acceptors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id59" title="Permalink to this definition"></a></dt>
<dd><p>Guesses which atoms could be considered acceptors in the analysis.</p>
<section id="id60">
<h3>Parameters<a class="headerlink" href="#id60" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>selection: str (optional)</dt><dd><p>Selection string for atom group from which acceptors will be
identified.</p>
</dd>
<dt>max_charge: float (optional)</dt><dd><p>Maximum allowed charge of an acceptor atom.</p>
</dd>
</dl>
</section>
<section id="id61">
<h3>Returns<a class="headerlink" href="#id61" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>potential_acceptors: str</dt><dd><p>String containing the <code class="xref py py-attr docutils literal notranslate"><span class="pre">resname</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> of all
atoms that potentially capable of forming hydrogen bonds.</p>
</dd>
</dl>
</section>
<section id="id62">
<h3>Notes<a class="headerlink" href="#id62" title="Permalink to this heading"></a></h3>
<p>This function makes use of and atomic charges to identify which atoms
could be considered acceptor atoms in the hydrogen bond analysis.
If an atom has an atomic charge less than <code class="xref py py-attr docutils literal notranslate"><span class="pre">max_charge</span></code> then it
is considered capable of participating in hydrogen bonds.</p>
<p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">acceptors_sel</span></code> is <cite>None</cite>, this function is called to guess
the selection.</p>
<p>Alternatively, this function may be used to quickly generate a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> of potential acceptor atoms involved in hydrogen bonding.
This <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> may then be modified before being used to set the
attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">acceptors_sel</span></code>.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id63">
<span class="sig-name descname"><span class="pre">guess_donors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.guess_donors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id63" title="Permalink to this definition"></a></dt>
<dd><p>Guesses which atoms could be considered donors in the analysis.
Only use if the universe topology does not contain bonding
information, otherwise donor-hydrogen pairs may be incorrectly
assigned.</p>
<section id="id64">
<h3>Parameters<a class="headerlink" href="#id64" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>selection: str (optional)</dt><dd><p>Selection string for atom group from which donors will be
identified.</p>
</dd>
<dt>max_charge: float (optional)</dt><dd><p>Maximum allowed charge of a donor atom.</p>
</dd>
</dl>
</section>
<section id="id65">
<h3>Returns<a class="headerlink" href="#id65" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>potential_donors: str</dt><dd><p>String containing the <code class="xref py py-attr docutils literal notranslate"><span class="pre">resname</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> of all
atoms that potentially capable of forming hydrogen bonds.</p>
</dd>
</dl>
</section>
<section id="id66">
<h3>Notes<a class="headerlink" href="#id66" title="Permalink to this heading"></a></h3>
<p>This function makes use of and atomic charges to identify which atoms
could be considered donor atoms in the hydrogen bond analysis. If an
atom has an atomic charge less than <code class="xref py py-attr docutils literal notranslate"><span class="pre">max_charge</span></code>, and it is
within <code class="xref py py-attr docutils literal notranslate"><span class="pre">d_h_cutoff</span></code> of a hydrogen atom, then it is considered
capable of participating in hydrogen bonds.</p>
<p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">donors_sel</span></code> is <cite>None</cite>, and the universe topology does not
have bonding information, this function is called to guess the
selection.</p>
<p>Alternatively, this function may be used to quickly generate a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> of potential donor atoms involved in hydrogen bonding.
This <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> may then be modified before being used to set the
attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">donors_sel</span></code>.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id67">
<span class="sig-name descname"><span class="pre">guess_hydrogens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.guess_hydrogens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id67" title="Permalink to this definition"></a></dt>
<dd><p>Guesses which hydrogen atoms should be used in the analysis.</p>
<section id="id68">
<h3>Parameters<a class="headerlink" href="#id68" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>selection: str (optional)</dt><dd><p>Selection string for atom group from which hydrogens will be
identified.</p>
</dd>
<dt>max_mass: float (optional)</dt><dd><p>Maximum allowed mass of a hydrogen atom.</p>
</dd>
<dt>min_charge: float (optional)</dt><dd><p>Minimum allowed charge of a hydrogen atom.</p>
</dd>
</dl>
</section>
<section id="id69">
<h3>Returns<a class="headerlink" href="#id69" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>potential_hydrogens: str</dt><dd><p>String containing the <code class="xref py py-attr docutils literal notranslate"><span class="pre">resname</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> of all
hydrogen atoms potentially capable of forming hydrogen bonds.</p>
</dd>
</dl>
</section>
<section id="id70">
<h3>Notes<a class="headerlink" href="#id70" title="Permalink to this heading"></a></h3>
<p>This function makes use of atomic masses and atomic charges to
identify which atoms are hydrogen atoms that are capable of
participating in hydrogen bonding. If an atom has a mass less than
<code class="xref py py-attr docutils literal notranslate"><span class="pre">max_mass</span></code> and an atomic charge greater than <code class="xref py py-attr docutils literal notranslate"><span class="pre">min_charge</span></code>
then it is considered capable of participating in hydrogen bonds.</p>
<p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">hydrogens_sel</span></code> is <cite>None</cite>, this function is called to guess
the selection.</p>
<p>Alternatively, this function may be used to quickly generate a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> of potential hydrogen atoms involved in hydrogen bonding.
This str may then be modified before being used to set the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">hydrogens_sel</span></code>.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id71">
<span class="sig-name descname"><span class="pre">merge_external_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'time'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#id71" title="Permalink to this definition"></a></dt>
<dd><p>Merge external data with the results of the analysis</p>
<section id="id72">
<h3>Parameters<a class="headerlink" href="#id72" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>df<span class="classifier">pd.DataFrame</span></dt><dd><p>Dataframe containing the data to merge</p>
</dd>
<dt>col<span class="classifier">str, optional</span></dt><dd><p>Column name to merge on, by default “time”</p>
</dd>
</dl>
</section>
<section id="id73">
<h3>Returns<a class="headerlink" href="#id73" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>pd.DataFrame</dt><dd><p>Dataframe with merged data</p>
</dd>
</dl>
</section>
<section id="id74">
<h3>Raises<a class="headerlink" href="#id74" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>ValueError</dt><dd><p>If no results are present</p>
</dd>
<dt>ValueError</dt><dd><p>If no data is merged</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id75">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'dask'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="colvar_parallel.base.html#colvar_parallel.base.ParallelAnalysisBase" title="colvar_parallel.base.ParallelAnalysisBase"><span class="pre">ParallelAnalysisBase</span></a></span></span><a class="headerlink" href="#id75" title="Permalink to this definition"></a></dt>
<dd><p>Perform the calculation</p>
<section id="id76">
<h3>Parameters<a class="headerlink" href="#id76" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>start<span class="classifier">int, optional</span></dt><dd><p>start frame of analysis</p>
</dd>
<dt>stop<span class="classifier">int, optional</span></dt><dd><p>stop frame of analysis</p>
</dd>
<dt>step<span class="classifier">int, optional</span></dt><dd><p>number of frames to skip between each analysed frame</p>
</dd>
<dt>frames<span class="classifier">array_like, optional</span></dt><dd><p>array of integers or booleans to slice trajectory; <cite>frames</cite> can
only be used <em>instead</em> of <cite>start</cite>, <cite>stop</cite>, and <cite>step</cite>. Setting
<em>both</em> <cite>frames</cite> and at least one of <cite>start</cite>, <cite>stop</cite>, <cite>step</cite> to a
non-default value will raise a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>.
.. versionadded:: 2.2.0</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>Turn on verbosity</p>
</dd>
<dt>n_jobs<span class="classifier">int, optional</span></dt><dd><p>number of jobs to start, if <cite>-1</cite> use number of logical cpu cores.
This argument will be ignored when the distributed scheduler is
used
.. versionadded:: PERSONAL-COPY</p>
</dd>
<dt>module<span class="classifier">str, optional</span></dt><dd><p>Parallelization module to use. Default: <code class="docutils literal notranslate"><span class="pre">&quot;multiprocessing&quot;</span></code>.
.. versionadded:: PERSONAL-COPY</p>
</dd>
<dt>method<span class="classifier">str, optional</span></dt><dd><p>Parallelization method to use. This is the Dask scheduler,
Joblib backend, or the multiprocessing method. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.
.. versionadded:: PERSONAL-COPY</p>
</dd>
<dt>n_blocks<span class="classifier">int, optional</span></dt><dd><p>number of blocks to divide trajectory into. If <code class="docutils literal notranslate"><span class="pre">None</span></code> set equal
to n_jobs or number of available workers in scheduler.
.. versionadded:: PERSONAL-COPY</p>
</dd>
<dt><a href="#id77"><span class="problematic" id="id78">**</span></a>kwargs</dt><dd><p>Other keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">dask.base.compute()</span></code>.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.2.0: </span>Added ability to analyze arbitrary frames by passing a list of
frame indices in the <cite>frames</cite> keyword argument.</p>
</div>
</section>
<section id="id79">
<h3>Returns<a class="headerlink" href="#id79" title="Permalink to this heading"></a></h3>
<dl>
<dt>self<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParallelAnalysisBase</span></code> instance</span></dt><dd><p>The instance itself.</p>
</dd>
</dl>
</section>
<section id="id80">
<h3>Raises<a class="headerlink" href="#id80" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>ValueError</dt><dd><p>If <cite>frames</cite> is used in conjunction with <cite>start</cite>, <cite>stop</cite>, or <cite>step</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id81">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/colvar_parallel/hbonds.html#HydrogenBondAnalysis.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id81" title="Permalink to this definition"></a></dt>
<dd><p>Save the results of the analysis to a parquet file. The results
are saved to the <cite>data</cite> directory in the <cite>dir_out</cite> directory.</p>
<p>This method should only be called after the analysis has been
run.</p>
<section id="id82">
<h3>Parameters<a class="headerlink" href="#id82" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>dir_out<span class="classifier">str, optional</span></dt><dd><p>The directory to save the results to. If not specified, the
results are saved to the directory specified in the
<cite>dir_out</cite> attribute.</p>
</dd>
</dl>
</section>
<section id="id83">
<h3>Raises<a class="headerlink" href="#id83" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>ValueError</dt><dd><p>If no dataframe is found.</p>
</dd>
<dt>ValueError</dt><dd><p>If no filename is found.</p>
</dd>
<dt>ValueError</dt><dd><p>If no output directory is specified.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="colvar_parallel.dihedrals.html" class="btn btn-neutral float-left" title="colvar_parallel.dihedrals module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="colvar_parallel.polymerlengths.html" class="btn btn-neutral float-right" title="colvar_parallel.polymerlengths module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Alec Glisman.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>